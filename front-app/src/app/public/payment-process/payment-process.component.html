<div class="min-h-screen flex-1 flex justify-center items-center" *ngIf="products | async">
  <div class="bg-white w-full md:max-w-4xl rounded-lg shadow">
  <div class="h-12 flex justify-between items-center border-b border-gray-200 m-4">
    <div >
     <div class="text-xl font-bold text-gray-700">List of products </div>
     
    </div>
    <div>
      <div class="flex items-center justify-center w-full pr-8">
        <button 
        routerLink="/"               
        class="bg-gray-800 p-1 rounded-full text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white">
          <span class="sr-only">back</span>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
          </svg>
        </button>  
      </div>
    </div>
  </div>
  <div class="px-6">
    <div class="flex justify-between items-center h-16 p-4 my-6  rounded-lg border border-gray-100 shadow-md" *ngFor="let product of products | async | paginate: { itemsPerPage: 3, currentPage: p } ; index as i;">
      <div class="flex items-center">
        <img class="rounded-full h-12 w-12" src="{{product.picture}}" alt="Logo" />
      <div class="ml-2">
        <div class="text-sm font-semibold text-gray-600">"{{product.name}}"</div>
        <div class="text-sm font-light text-gray-500">
          <a class="text-indigo-600 hover:text-indigo-500" href="#"> View more .</a>
        </div>
      </div>
      </div>
    <div class="ml-8">
      <input
      [(ngModel)]="valuesInputs[product.idproc].quantity"
      (ngModelChange)="changeModel($event,product.id, product.price)"
      (change)="viewToModelUpdate(product.id,product)" 
      (input)="dataInput.next(
        {
          productchange:product,
          qchnage:$event.target.value
        })"
      type="text" 
      class="disable-text-selection  border border-transparent shadow px-1 py-2 leading-normal text-gray-700 bg-white rounded-md focus:outline-none focus:shadow-outline text-center"
      value="{{product.quantity}}">
    </div>
    <div>
        <button class="bg-red-400 hover:bg-red-500 p-2 rounded-full shadow-md flex justify-center items-center" (click)="updateAmountDelete(product.id)" >
          <svg class="text-white toggle__lock w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
    </div>
    </div>
    <div class="flex justify-between items-center h-16 p-4 my-6  rounded-lg border border-gray-100 shadow-md">
      <div class="flex items-center">
        <pagination-controls (pageChange)="p = $event"></pagination-controls>
      </div>
      <div>
         $ {{totalprice}}
      </div>
    </div>
    
  </div>
  </div>
</div>
<div class="flex items-center justify-center px-5 pb-1 pt-1" *ngIf="products | async ; else elseBlock">
    <div class="w-full mx-auto rounded-lg bg-white shadow-lg p-5 text-gray-700" style="max-width: 600px">
        <div class="w-full pt-1 pb-5">
            <div class="bg-indigo-500 text-white overflow-hidden rounded-full w-20 h-20 -mt-16 mx-auto shadow-lg flex justify-center items-center">
                <i class="mdi mdi-credit-card-outline text-3xl"></i>
            </div>
        </div>
        <div class="mb-10">
            <h1 class="text-center font-bold text-xl uppercase">Secure payment info</h1>
        </div>
        <div class="mb-3 flex -mx-2">
            <div class="px-2">
                <label for="type1" class="flex items-center cursor-pointer">
                    <input type="radio" class="form-radio h-5 w-5 text-indigo-500" name="type" id="type1" checked>
                    <img src="https://leadershipmemphis.org/wp-content/uploads/2020/08/780370.png" class="h-8 ml-3">
                </label>
            </div>
            <div class="px-2">
                <label for="type2" class="flex items-center cursor-pointer">
                    <input type="radio" class="form-radio h-5 w-5 text-indigo-500" name="type" id="type2">
                    <img src="https://www.sketchappsources.com/resources/source-image/PayPalCard.png" class="h-8 ml-3">
                </label>
            </div>
        </div>
        <div class="mb-3">
            <label for="Name of card" 
                [className]="'font-bold text-sm mb-2 ml-1'" 
                [ngClass]="{'text-red-400' : (validationPaymentService.obsNameOfCard | async) === false }">Name on card</label>
            <div>
                <input 
                (input)="
                validationPaymentService.inputNameOfCard( $event.target.value);
                subgetMynamecard.next($event.target.value);"
                [className]="'w-full px-3 py-2 mb-1 border-2 border-gray-200 rounded-md focus:outline-none '" 
                [ngClass]="
                {
                  'border border-transparent border-red-400 focus:outline-none focus:ring-2 focus:ring-red-400 focus:border-transparent' : 
                  (validationPaymentService.obsNameOfCard | async) === false
                }"
                placeholder="John Smith" 
                type="text"/>
            </div>
        </div>
        <div class="mt-1">
          <span *ngIf="(validationPaymentService.obsNameOfCard | async) === false;" class="text-red-400" >Name of card is required</span>
        </div>
        <div class="mb-3">
            <label for="Number of card" 
            [className]="'font-bold text-sm mb-2 ml-1'" 
            [ngClass]="{'text-red-400' : (validationPaymentService.obsCardNumber | async) === false ||  (validationPaymentService.obsLengthCard | async) === false   }">
            Card number</label>
            <div>
                <input 
                (input)="
                validationPaymentService.inputCardNumber( $event.target.value);  
                validationPaymentService.inputLengthCard( $event.target.value); 
                subgetCreditNumber.next($event.target.value);
                subgetMynumbercard.next($event.target.value);
                "
                [className]="'w-full px-3 py-2 mb-1 border-2 border-gray-200 rounded-md focus:outline-none'" 
                [ngClass]="
                {
                  'border border-transparent border-red-400 focus:outline-none focus:ring-2 focus:ring-red-400 focus:border-transparent' : 
                  (validationPaymentService.obsCardNumber | async) === false || (validationPaymentService.obsLengthCard | async) === false  
                }"
                maxlength="19"
                value="{{valueInputcard}}"
                mask="0000-0000-0000-0000"
                placeholder="0000-0000-0000-0000" type="text"/>
            </div>
        </div>
        <div class="mt-1">
          <span *ngIf="(validationPaymentService.obsCardNumber | async) === false; else elseBlockLength " class="text-red-400" >Number card is required</span>
          <ng-template #elseBlockLength>
            <span *ngIf="(validationPaymentService.obsLengthCard | async) === false; " class="text-red-400" >Number card is at least 16 caracters </span>
          </ng-template>
          
        </div>
        <div class="mb-3 -mx-2 flex items-end">
            <div class="px-2 w-1/2">
                <label class="font-bold text-sm mb-2 ml-1">Expiration date</label>
                <div>
                    <select class="form-select w-full px-3 py-2 mb-1 border-2 border-gray-200 rounded-md focus:outline-none focus:border-indigo-500 transition-colors cursor-pointer">
                        <option value="01">01 - January</option>
                        <option value="02">02 - February</option>
                        <option value="03">03 - March</option>
                        <option value="04">04 - April</option>
                        <option value="05">05 - May</option>
                        <option value="06">06 - June</option>
                        <option value="07">07 - July</option>
                        <option value="08">08 - August</option>
                        <option value="09">09 - September</option>
                        <option value="10">10 - October</option>
                        <option value="11">11 - November</option>
                        <option value="12">12 - December</option>
                    </select>
                </div>
            </div>
            <div class="px-2 w-1/2">
                <select class="form-select w-full px-3 py-2 mb-1 border-2 border-gray-200 rounded-md focus:outline-none focus:border-indigo-500 transition-colors cursor-pointer">
                    <option value="2020">2020</option>
                    <option value="2021">2021</option>
                    <option value="2022">2022</option>
                    <option value="2023">2023</option>
                    <option value="2024">2024</option>
                    <option value="2025">2025</option>
                    <option value="2026">2026</option>
                    <option value="2027">2027</option>
                    <option value="2028">2028</option>
                    <option value="2029">2029</option>
                </select>
            </div>
        </div>
        <div class="mb-10">
          <label for="Number of card" 
            [className]="'font-bold text-sm mb-2 ml-1'" 
            [ngClass]="{'text-red-400' : (validationPaymentService.obsSecurityCode | async) === false }">
            Security code</label>
            <div>
                <input 
                (input)="
                validationPaymentService.inputSecurityCode( $event.target.value);
                subgetSecurityCode.next($event.target.value)
                "
                [className]="'w-32 px-3 py-2 mb-1 border-2 border-gray-200 rounded-md focus:outline-none'" 
                [ngClass]="
                {
                  'border border-transparent border-red-400 focus:outline-none focus:ring-2 focus:ring-red-400 focus:border-transparent' : 
                  (validationPaymentService.obsSecurityCode | async) === false
                }"
                mask="000"
                placeholder="000" type="text"/>
            </div>
            <div class="mt-1">
              <span *ngIf="(validationPaymentService.obsSecurityCode | async) === false;" class="text-red-400" >Security Code is required</span>
            </div>
        </div>
        <div>
            <button 
            (click)="payNow()"
            class="block w-full max-w-xs mx-auto bg-indigo-500 hover:bg-indigo-700 focus:bg-indigo-700 text-white rounded-lg px-3 py-3 font-semibold">
              <i class="mdi mdi-lock-outline mr-1"></i> PAY NOW</button>
        </div>
    </div>
</div>

<ng-template #elseBlock>
    <div class="min-h-screen flex-1 flex justify-center items-center">
      <div class="bg-white w-full md:max-w-4xl rounded-lg shadow">
      <div class="h-12 flex justify-between items-center border-b border-gray-200 m-4">
        <div >
         <div class="text-xl font-bold text-gray-700">
            <label class="mr-4">First you should select products to buy</label> 
            <button 
            routerLink="/"               
            class="bg-gray-800 p-1 rounded-full text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white">
              <span class="sr-only">back</span>
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
              </svg>
            </button>
         </div>         
        </div>
      </div>
      </div>
    </div>
</ng-template>
<app-message-box #messageBoxComponent [message]="messageValidation"></app-message-box>
